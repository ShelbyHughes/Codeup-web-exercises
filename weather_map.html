<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dark Sky Project</title>
    <style>
        .weatherCards{
            background-color: lightgrey;
            border: 1px solid grey;
            text-align: center;
        }
        .mainBackground{
            background-color: skyblue;
        }
        #map{
            width: 100%;
            height: 700px;
            grid-area: map;
        }
        body {
            display: grid;
            grid-template-areas:
                    "header header header"
                    "header2 header2 header2"
                    "current_weather tomorrows_weather day_after"
                    "lat long long"
                    "map map map"
                    "map map map";
            grid-template-rows: 60px 60px 480px;
            grid-template-columns: 33% 33% 33%;
            grid-row-gap: 10px;
            grid-column-gap: 10px;
            height: 100vh;
            margin: 10px;
        }
        #header{
            grid-area: header;
        }
        #header2{
            grid-area: header2;
        }
        #current_weather{
            grid-area: current_weather;
        }
        #tomorrows_weather{
            grid-area: tomorrows_weather;
        }
        #day_after{
            grid-area: day_after;
        }
        #lat{
            grid-area: lat;
        }
        #long{
            grid-area: long;
        }

    </style>
</head>
<body class="mainBackground">
<h1 id="header">Weather Application</h1>
<div id="header2">
    <h3 id="location">San Antonio</h3>
</div>
<div class="Today-weather weatherCards" id="current_weather"></div>
<div class="Tomorrow-weather weatherCards" id="tomorrows_weather"></div>
<div class="Next-weather weatherCards" id="day_after"></div>

<form>
    Latitude:<br>
    <input type="text" name="latitude" placeholder="Enter Latitude Here" id="lat"><br>
    Longitude:<br>
    <input type="text" name="longitude" placeholder="Enter Longitude Here" id="long"><br>
    <input type="submit" value="Submit" id="go-getter">
</form>

<br/>
<div id="map"></div>
<script src="js/keys.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
<script src="js/mapbox-geocoder-utils.js"></script>
<script>
    // Array of icons
    var iconArray = {
        'clear-day':"icon/Sun.svg",
        'clear-night':"icon/Moon.svg",
        'rain': "icon/Cloud-Drizzle-Alt.svg",
        'snow': "icon/Cloud-Snow-Alt.svg",
        'sleet': "icon/Cloud-Hail-Alt.svg",
        'wind': "icon/Cloud-Wind.svg",
        'fog': "icon/Cloud-Fog-Alt.svg",
        'cloudy': "icon/Cloud.svg",
        'partly-cloudy-day':"icon/Cloud-Wind-Sun.svg",
        'partly-cloudy-night':"icon/Cloud-Wind-Moon.svg"
    };
        "use strict";
        $(document).ready(function () {
            getWeather(29.4241, -98.4936);
            // dark skys api call
           // var weather =  $.ajax("https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/" + darkSkyToken + "/29.4241,-98.4936")
           //  weather.done(function(weather){
           //
           //      //Todays weather card
           //  $('.Today-weather').append(
           //      '<div class="d-flex-col justify-content-center">' +
           //      '<h5 class="d-flex justify-content-center">' + "Todays Weather " + '</h5>' +
           //      '<img src="'+ iconArray[weather.daily.data[0].icon] +'" class="mt-2" style="width: 30%">' +
           //      '<p class="d-flex justify-content-center mt-2">' + weather.daily.data[0].temperatureHigh + '° F' + ' / ' + weather.daily.data[0].temperatureLow + '° F' + '</p>' +
           //      '<p class="d-flex justify-content-center mt-2">' + "The Sky is " + weather.daily.data[0].summary + '</p>' +
           //      '<p class="d-flex justify-content-center mt-2">' + "Humidity: " + weather.daily.data[0].humidity + "%" + '</p>' +
           //      '<p class="d-flex justify-content-center mt-2">' + "Wind: " + weather.daily.data[0].windSpeed + " MPH" + '</p>' +
           //      '<p class="d-flex justify-content-center mt-2">' + "Pressure: " + weather.daily.data[0].pressure + '</p>' +
           //      '</div>'
           //  );
           //      //Tomorrows weather card
           //  $('.Tomorrow-weather').append(
           //      '<div class="d-flex-col justify-content-center">' +
           //      '<h5 class="d-flex justify-content-center">' + "Tomorrow Weather " + '</h5>' +
           //      '<img src="'+ iconArray[weather.daily.data[1].icon] +'" class="mt-2" style="width: 30%">' +
           //      '<p class="d-flex justify-content-center mt-2">' + weather.daily.data[1].temperatureHigh + '° F' + ' / ' + weather.daily.data[1].temperatureLow + '° F' + '</p>' +
           //      '<p class="d-flex justify-content-center mt-2">' + "The Sky is " + weather.daily.data[1].summary + '</p>' +
           //      '<p class="d-flex justify-content-center mt-2">' + "Humidity: " + weather.daily.data[1].humidity + "%" + '</p>' +
           //      '<p class="d-flex justify-content-center mt-2">' + "Wind: " + weather.daily.data[1].windSpeed + " MPH" + '</p>' +
           //      '<p class="d-flex justify-content-center mt-2">' + "Pressure: " + weather.daily.data[1].pressure + '</p>' +
           //      '</div>'
           //  );
           //  //Next Day weather card
           //  $('.Next-weather').append(
           //      '<div class="d-flex-col justify-content-center">' +
           //      '<h5 class="d-flex justify-content-center">' + "Next Day Weather " + '</h5>' +
           //      '<img src="'+ iconArray[weather.daily.data[2].icon] +'" class="mt-2" style="width: 30%">' +
           //      '<p class="d-flex justify-content-center mt-2">' + weather.daily.data[2].temperatureHigh + '° F' + ' / ' + weather.daily.data[2].temperatureLow + '° F' +'</p>' +
           //      '<p class="d-flex justify-content-center mt-2">' + "The Sky is " + weather.daily.data[2].summary + '</p>' +
           //      '<p class="d-flex justify-content-center mt-2">' + "Humidity: " + weather.daily.data[2].humidity + "%" + '</p>' +
           //      '<p class="d-flex justify-content-center mt-2">' + "Wind: " + weather.daily.data[2].windSpeed + " MPH" + '</p>' +
           //      '<p class="d-flex justify-content-center mt-2">' + "Pressure: " + weather.daily.data[2].pressure + '</p>' +
           //      '</div>');
           //
           //  });
            function getWeather(latitude, longitude){
                var weather =  $.ajax("https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/" + darkSkyToken + "/" + latitude +',' + longitude);
                weather.done(function(weather){
                    console.log(weather);

                    $("#location").html(latitude + ', ' + longitude);
                    //Todays weather card
                    $('.Today-weather').empty().append(
                        '<div class="d-flex-col justify-content-center">' +
                        '<h5 class="d-flex justify-content-center">' + "Todays Weather " + '</h5>' +
                        '<img src="'+ iconArray[weather.daily.data[0].icon] +'" class="mt-2" style="width: 30%">' +
                        '<p class="d-flex justify-content-center mt-2">' + weather.daily.data[0].temperatureHigh + '° F' + ' / ' + weather.daily.data[0].temperatureLow + '° F' + '</p>' +
                        '<p class="d-flex justify-content-center mt-2">' + "The Sky is " + weather.daily.data[0].summary + '</p>' +
                        '<p class="d-flex justify-content-center mt-2">' + "Humidity: " + weather.daily.data[0].humidity + "%" + '</p>' +
                        '<p class="d-flex justify-content-center mt-2">' + "Wind: " + weather.daily.data[0].windSpeed + " MPH" + '</p>' +
                        '<p class="d-flex justify-content-center mt-2">' + "Pressure: " + weather.daily.data[0].pressure + '</p>' +
                        '</div>');

                    //Tomorrows weather card
                    $('.Tomorrow-weather').empty().append(
                        '<div class="d-flex-col justify-content-center">' +
                        '<h5 class="d-flex justify-content-center">' + "Tomorrow Weather " + '</h5>' +
                        '<img src="'+ iconArray[weather.daily.data[1].icon] +'" class="mt-2" style="width: 30%">' +
                        '<p class="d-flex justify-content-center mt-2">' + weather.daily.data[1].temperatureHigh + '° F' + ' / ' + weather.daily.data[1].temperatureLow + '° F' + '</p>' +
                        '<p class="d-flex justify-content-center mt-2">' + "The Sky is " + weather.daily.data[1].summary + '</p>' +
                        '<p class="d-flex justify-content-center mt-2">' + "Humidity: " + weather.daily.data[1].humidity + "%" + '</p>' +
                        '<p class="d-flex justify-content-center mt-2">' + "Wind: " + weather.daily.data[1].windSpeed + " MPH" + '</p>' +
                        '<p class="d-flex justify-content-center mt-2">' + "Pressure: " + weather.daily.data[1].pressure + '</p>' +
                        '</div>');

                    //Next Day weather card
                    $('.Next-weather').empty().append(
                        '<div class="d-flex-col justify-content-center">' +
                        '<h5 class="d-flex justify-content-center">' + "Next Day Weather " + '</h5>' +
                        '<img src="'+ iconArray[weather.daily.data[2].icon] +'" class="mt-2" style="width: 30%">' +
                        '<p class="d-flex justify-content-center mt-2">' + weather.daily.data[2].temperatureHigh + '° F' + ' / ' + weather.daily.data[2].temperatureLow + '° F' +'</p>' +
                        '<p class="d-flex justify-content-center mt-2">' + "The Sky is " + weather.daily.data[2].summary + '</p>' +
                        '<p class="d-flex justify-content-center mt-2">' + "Humidity: " + weather.daily.data[2].humidity + "%" + '</p>' +
                        '<p class="d-flex justify-content-center mt-2">' + "Wind: " + weather.daily.data[2].windSpeed + " MPH" + '</p>' +
                        '<p class="d-flex justify-content-center mt-2">' + "Pressure: " + weather.daily.data[2].pressure + '</p>' +
                        '</div>');

                });
            }
            mapboxgl.accessToken = mapboxToken;
            var map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/streets-v9',
                zoom: 10,
                center: [-98.53492, 29.55742]
            });
            $('#go-getter').click(function(e){
                e.preventDefault();
                console.log({lng:long.value, lat:lat.value})
                reverseGeocode({lng:long.value, lat:lat.value}, mapboxToken).then(function (result) {
                    console.log(result);
                    map.setCenter(result)
                    map.setZoom(15)
                    var marker = new mapboxgl.Marker()
                        .setLngLat(result)
                        .addTo(map);
                });
                getWeather(lat.value,long.value);
            })
         });


</script>
</body>
</html>